---
title: "How to use harmony-py to spatially subset ICESat-2data"
author: Mikala Beig and Andy Barrett
date: last-modified
execute:
  freeze: auto
---

## Problem
How can I spatially subset ATLAS/ICESat-2 Land-ice Height (ATL06) data using the harmony-py Python library?

## Solution


```python
from harmony-py BBox, Client, Collection, Request
import datetime as dt
from IPython.display import display, JSON
```

Initialize your Harmony client
```python 
harmony_client = Client()
```

Define your spatial bounds (min_lon, min_lat, max_lon, max_lat). Example below is over the Juneau Ice Field in Alaska.
```python
bbox = BBox(-134.7,58.9,-133.9,59.2)
```
Define your temporal range (passed as a dictionary with "start" and "stop" keys, and dates supplied as datetime objects).
```python
temporal = {'start': dt.datetime(2020, 4, 27),'stop': dt.datetime(2020, 5, 28)}
```
Define which data set you'd like to access using the collection concept-id (see [how-to](./how-to-guides/get_concept_ids.qmd) for retrieving collection concept-ids). For this example, we'll use ATL06 version 007, C3564876127-NSIDC_CPRD.
```python
collection = Collection(id='C3564876127-NSIDC_CPRD') 
```
Build the request
```python
request = Request(
    collection=collection,
    spatial=bbox,
    temporal=temporal
)
```
Submit the request
```python
job_id = harmony_client.submit(request)
```
Check on Harmony job progress
```python
harmony_client.wait_for_processing(job_id, show_progress=True)
```
Download the results to your local directory
```python
futures = harmony_client.download_all(job_id, directory=".", overwrite=False)
filelist = [f.result() for f in futures]  # get filepaths
len(filelist)
```

## Discussion
